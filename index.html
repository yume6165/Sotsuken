<!DOCTYPE html>
<html>
  <head>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet">
    <style type="text/css">
      #network {
        width:  400px;
        height: 400px;
        border: 1px solid #000;
      }
    </style>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
  </head>
  <body>

    
    <div id="network"></div>
    <script type="text/javascript">
      
function RGB2Hex(rgb)//３次元配列で入力
      {
        color_list = []
        r1 = String(rgb[0] / 16);
        color_list.push(r1);
        r2 = String(rgb[0] % 16);
        color_list.push(r2);
        g1 = String(rgb[1] / 16);
        color_list.push(g1);
        g2 = String(rgb[1] % 16);
        color_list.push(g2);
        b1 = String(rgb[2] / 16);
        color_list.push(b1);
        b2 = String(rgb[2] % 16);
        color_list.push(b2);
        var color = '#';
        
        for(var i=0; i < color_list.length; i++)
        {
          if(color_list[i] >= 10)
          {
              switch(color_list[i])
              {
                case '10': color_list[i] ="A"
                  break;
                case '11': color_list[i] ="B";
                  break;
                case '12': color_list[i] ="C";
                  break;
                case '13': color_list[i] ="D";
                  break;
                case '14': color_list[i] ="E";
                  break;
                case '15': color_list[i] ="F";
                  break;
                
              }
          }
          color += color_list[i];
        }
        
        
      }

function csvToArray(path) {
        var csvData = new Array();
        var data = new XMLHttpRequest();        
        data.open("GET", path, false);
        data.send(null);
        var LF = String.fromCharCode(10);
        var lines = data.responseText.split(LF);
        for (var i = 0; i < lines.length;++i) {
                var cells = lines[i].split(",");
                if( cells.length != 1 ) {
                        csvData.push(cells);
                }
        }
        return csvData;
}
      
      //ここからグラフ描画のための準備
      
      distance = [];
      distances = []
      
      //forで回したいけど方法がわからない
      distance.push(csvToArray("https://cdn.glitch.com/a71c879d-dcf2-41d9-accb-3bac81f35ea0%2F0_all_context.csv?v=1576165789415"));
      distances.push(distance);
      distance.push(csvToArray("https://cdn.glitch.com/a71c879d-dcf2-41d9-accb-3bac81f35ea0%2F1_incision_context.csv?v=1576165789283"));
      distances.push(distance);
      distance.push(csvToArray("https://cdn.glitch.com/a71c879d-dcf2-41d9-accb-3bac81f35ea0%2F2_contusion_context.csv?v=1576165789447"));
      distances.push(distance);
      
      
      console.log(distances);
      c_num = distances.length;
      i_num = distance[0].length;
      
      //各文脈に関してノードを生成（どの文脈でもノードは変わらないからいらない説）
      context_nodes_list =[];
      for(var k=0; k < c_num; k++)
      {
        node_list = [];
        for(var i = 0; i < i_num; i++)
        {
          var a = {id: i, label: String(i)};
          node_list.push(a);
        }
        var nodes = new vis.DataSet(node_list);
        context_nodes_list.push(nodes);
      }
      
      context_edges_list =[];
      for(var k=0; k < c_num; k++)
      {
        edge_list = [];
        for(var i = 0; i < i_num; i++)
        {
          for(var j = i+1; j < i_num ; j++)
          {
            w = Number(distances[0][k][i][j])*5;//数字かけて太さをわかりやすくしている
            //console.log(distances[0][k][i][j]);
            
            
            var a = {from: i, to: j, width:w, color:'red'};
            edge_list.push(a);
          }
        }
        var edges = new vis.DataSet(edge_list);
        context_edges_list.push(edges);
      }
      
     
      
      var container = document.getElementById('network');
      //c_numでコンテクストの数がわかっているので、そこから切り替える
      var data = {
        nodes: context_nodes_list[0],
        edges: context_edges_list[0]
      };
      var options = {
        
      };
      var network = new vis.Network(container, data, options);
      
      
      //ノードがクリックされたときの処理
      network.on("click", function(params) {
        if (params.nodes.length == 1) {
          var nodeId = params.nodes[0];
          var node = nodes.get(nodeId);
          console.log(node.label + 'がクリックされました');
        }
      });
      
      
      
    </script>
  <body>
</html>